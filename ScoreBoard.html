<!--
TODO:„Çπ„Ç≥„Ç¢„Ç∑„Éº„Éà„ÇíËøΩÂä†
TODO:PWA
-->
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Badminton Scoreboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            background: #005500;
            font-family: arial, sans-serif;
            font-weight: bold;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        .score-box {
            color: #fff;
            float: left;
            width: 50%;
            height: 100vh;
            line-height: 2;
            position: relative;
            letter-spacing: -20px;
        }

        .score {
            font-size: 1000%;
            height: 50%;
            text-align: center;
        }

        .game_set_A {
            font-size: 120%;
            text-align: center;

        }

        .game_set_B {
            font-size: 120%;
            text-align: center;
        }

        .saab {
            height: 75%;
            text-align: center;
        }

        .score-box:first-child {
            border-right: 2px solid yellow;
            background: #006600;
        }

        .active {
            color: yellow;
        }

        .control {
            position: absolute;
            bottom: 10%;
            width: 100%;
        }

        .btn_ {
            color: #ccc;
            font-size: 40px;
            display: block;
            float: left;
            width: 50%;
            height: 100px;
            text-align: center;
            text-decoration: none;
            line-height: 2.5;
            opacity: .7;
        }

        .reset,
        .switch,
        .setting,
        .difference,
        .score_sheet_btn {
            background: #004400;
            border-radius: 4px;
            color: #fff;
            display: block;
            font-weight: 100;
            width: 60px;
            height: 40px;
            line-height: 2.5;
            text-align: center;
            position: absolute;
            top: 15px;
            text-decoration: none;
        }

        .reset {
            left: 10px;
        }

        .switch {
            left: 80px;
        }

        .difference {
            left: 45%;
        }

        .score_sheet_btn {
            right: 80px;
        }

        .setting {
            right: 10px;
        }
    </style>
</head>

<body>
    <div class="ScoreBoard">
        <div class="score-box" id="score-box_A">
            <p class="score" id="scoreA" onclick="score('A_plus')">
                0
            </p>
            <p class="game_set_A" id="game_set_A">
                0
            </p>
            <div class="control" id="control">
                <a class="btn_ minusA" onclick="score('A_minus')">&minus;</a>
                <a class="btn_ plusA" onclick="score('A_plus')">&plus;</a>
            </div>
        </div>
        <div class="score-box" id="score-box_B">
            <p class="score" id="scoreB" onclick="score('B_plus')">
                0
            </p>
            <p class="game_set_B" id="game_set_B">
                0
            </p>
            <div class="control" id="control">
                <a class="btn_ minusB" onclick="score('B_minus')">&minus;</a>
                <a class="btn_ plusB" onclick="score('B_plus')">&plus;</a>
            </div>
        </div>
        <span class="difference" id="difference">ÁÇπÂ∑Æ</span>
        <a class="reset" id="reset">reset</a>
        <a class="switch" id="switch">change</a>
        <a class="score_sheet_btn" id="score_sheet_btn" data-bs-toggle="modal"
            data-bs-target="#staticBackdrop_score_sheet">sheet</a>
        <a class="setting" id="setting" data-bs-toggle="modal" data-bs-target="#staticBackdrop_setting">‚öôË®≠ÂÆö</a>
        <div class="modal fade" id="staticBackdrop_setting" data-bs-backdrop="static" data-bs-keyboard="false"
            tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">Ë®≠ÂÆö</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="color">
                            <label class="form-check-label" for="color">Ëâ≤„Çí‰ªò„Åë„Çã„Åã</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="game_set" checked>
                            <label class="form-check-label" for="game_set">„Ç≤„Éº„É†„Çª„ÉÉ„ÉàÊï∞„ÇíË°®Á§∫„Åô„Çã„Åã</label>
                        </div>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="saab" checked>
                            <label class="form-check-label" for="saab">„Çµ„Éº„Éñ„ÇíË°®Á§∫üè∏</label>
                        </div>
                        <hr>
                        <label for="max_score" class="form-label">ÊúÄÈ´òÂæóÁÇπ</label>
                        <p id="max_score_display">
                            21
                        </p>
                        <input type="range" class="form-range" min="10" max="30" id="max_score" value="21">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Èñâ„Åò„Çã</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="staticBackdrop_score_sheet" data-bs-backdrop="static" data-bs-keyboard="false"
            tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">„Çπ„Ç≥„Ç¢„Ç∑„Éº„Éà</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div id="score_sheet">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Èñâ„Åò„Çã</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var score_sheet = [{
            "scoreA": false,
            "scoreB": false
        }];
        function score(e) {
            var scoreA = Number(document.getElementById('scoreA').textContent);
            var scoreB = Number(document.getElementById('scoreB').textContent);
            if (e.indexOf('_') !== -1) {
                result = e.split('_');
                var score = Number(document.getElementById(`score${result[0]}`).textContent);
                var total_score = scoreA + scoreB

                if (result[1] == "plus") {
                    document.getElementById(`score${result[0]}`).innerText = score + 1;
                    var score_n = Number(document.getElementById(`score${result[0]}`).textContent);
                    var set_n = Number(document.getElementById(`game_set_${result[0]}`).textContent);
                    if (result[0] === "A") {
                        var addData = {
                            "scoreA": true,
                            "scoreB": false
                        }
                    } else if (result[0] === "B") {
                        var addData = {
                            "scoreA": false,
                            "scoreB": true
                        }
                    }
                    score_sheet.push(addData);
                    set_saab(result[0]);
                    //ÊúÄÈ´òÂæóÁÇπ„ÇíË∂Ö„Åà„Å¶„ÅÑ„ÇãÂ†¥Âêà
                    if (score_n >= $("#max_score").val()) {
                        $('#control, #control, .score, .score').hide('slow');
                        setTimeout(function () {
                            $("#scoreA").text("0")
                            $("#scoreB").text("0")
                            $("#difference").text("ÁÇπÂ∑Æ:0")
                            $("#game_set_" + result[0]).text(set_n + 1)
                            set_color();
                            set_saab();
                        }, 1000);
                        $('#control, #control, .score, .score').show('slow');
                    }

                } else if (result[1] == "minus") {
                    if (score > 0) {
                        document.getElementById(`score${result[0]}`).innerText = score - 1;
                    }
                }
            }
            set_color();
            set_difference();
        }
        function set_color() {
            var scoreA = Number(document.getElementById('scoreA').textContent);
            var scoreB = Number(document.getElementById('scoreB').textContent);
            if (scoreA > scoreB) {
                if ($("#color").prop('checked')) {
                    $("#scoreA").css("color", "red");
                    $("#scoreB").css("color", "blue");
                }
            } else if (scoreA < scoreB) {
                if ($("#color").prop('checked')) {
                    $("#scoreB").css("color", "red");
                    $("#scoreA").css("color", "blue");
                }
            } else if (scoreA === scoreB) {
                if ($("#color").prop('checked')) {
                    $("#scoreA").css("color", "blue");
                    $("#scoreB").css("color", "blue");
                }
            }
        }
        function set_difference() {
            var scoreA = Number(document.getElementById('scoreA').textContent);
            var scoreB = Number(document.getElementById('scoreB').textContent);
            if (scoreA > scoreB) {
                $("#difference").text(`ÁÇπÂ∑Æ:${scoreA - scoreB}`);
            } else if (scoreA < scoreB) {
                $("#difference").text(`ÁÇπÂ∑Æ:${scoreB - scoreA}`);

            } else if (scoreA === scoreB) {
                $("#difference").text("ÁÇπÂ∑Æ:0");
            }
        }
        function set_saab(A_or_B = null) {
            if (A_or_B === null) {
                $(".saab").remove();
                return
            }

            if ($("#saab").prop("checked")) {
                $(".saab").remove();
                $("#score-box_" + A_or_B).append("<p class='saab'>üè∏</p>");
            }
        }
    

    
        $("#reset").on("click", function () {
            $("#scoreA, #scoreB, #game_set_A, #game_set_B").text(0)
            $(".saab").remove();

        });
        $("#switch").on("click", function () {
            var scoreA = Number(document.getElementById('scoreA').textContent);
            var scoreB = Number(document.getElementById('scoreB').textContent);
            //„Çπ„Ç≥„Ç¢
            $("#scoreA").text(scoreB);
            $("#scoreB").text(scoreA);
            //„Çª„ÉÉ„ÉàÊï∞
            var gsA = $("#game_set_A").text()
            var gsB = $("#game_set_B").text()
            $("#game_set_A").text(gsB)
            $("#game_set_B").text(gsA)
        });
        $("input[type=range]").on("input", function () {
            $('#max_score_display').text($("#max_score").val());
        });
        $("#color").change(function () {
            if (this.checked) {
                set_color()
            } else {
                $("#scoreA").css("color", "#FFF");
                $("#scoreB").css("color", "#FFF");
            }
        })
        $("#game_set").change(function () {
            if (this.checked) {
                $('#game_set_A, #game_set_B').show('slow');

            } else {
                $('#game_set_A, #game_set_B').hide('slow');

            }
        })
        $("#saab").change(function () {
            if (this.checked) { } else {
                $(".saab").remove();
            }
        })
        $("#score_sheet_btn").on("click", function () { });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
</body>

</html>