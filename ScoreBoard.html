<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Badminton Scoreboard</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            background: #005500;
            font-family: arial, sans-serif;
            font-weight: bold;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        .score-box {
            color: #fff;
            font-size: 2000%;
            float: left;
            text-align: center;
            width: 50%;
            height: 100vh;
            line-height: 2;
            position: relative;
            letter-spacing: -20px;
        }

        .score-box:first-child {
            border-right: 2px solid yellow;
            background: #006600;
        }

        .active {
            color: yellow;
        }

        .control {
            position: absolute;
            bottom: 10%;
            width: 100%;
        }

        .btn_ {
            color: #ccc;
            font-size: 40px;
            display: block;
            float: left;
            width: 50%;
            height: 100px;
            text-align: center;
            text-decoration: none;
            line-height: 2.5;
            opacity: .7;
        }

        .reset,
        .switch,
        .setting,
        .difference {
            background: #004400;
            border-radius: 4px;
            color: #fff;
            display: block;
            font-weight: 100;
            width: 60px;
            height: 40px;
            line-height: 2.5;
            text-align: center;
            position: absolute;
            top: 15px;
            text-decoration: none;
        }

        .reset {
            left: 10px;
        }

        .switch {
            left: 80px;
        }

        .difference {
            left: 45%;
        }

        .setting {
            right: 15px;
        }
    </style>
    <script>
        $("input[type=range]").on("input", function() {
            console.log("!");
            $('#max_score_display').text($("#max_score_display").val());
        });
    </script>
</head>

<body id="body">
    <div class="ScoreBoard">
        <div class="score-box">
            <span class="scoreA" id="scoreA" onclick="score('A_plus')">0</span>
            <div class="control" id="control">
                <a class="btn_ minusA" onclick="score('A_minus')">&minus;</a>
                <a class="btn_ plusA" onclick="score('A_plus')">&plus;</a>
            </div>
        </div>
        <div class="score-box">
            <span class="scoreB" id="scoreB" onclick="score('B_plus')">0</span>
            <div class="control" id="control">
                <a class="btn_ minusB" onclick="score('B_minus')">&minus;</a>
                <a class="btn_ plusB" onclick="score('B_plus')">&plus;</a>
            </div>
        </div>
        <span class="difference" id="difference">点差:0</span>
        <a class="reset" onclick="score('reset')">reset</a>
        <a class="switch" onclick="score('switch')">change</a>
        <a class="setting" id="setting" data-bs-toggle="modal" data-bs-target="#staticBackdrop">⚙設定</a>
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="staticBackdropLabel">設定</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <label for="max_score" class="form-label">最高得点</label>
                        <p id="max_score_display">！</p>
                        <input type="range" class="form-range" min="10" max="30" id="max_score">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Understood</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function score(e) {
            var scoreA = Number(document.getElementById('scoreA').textContent);
            var scoreB = Number(document.getElementById('scoreB').textContent);
            if (e == "switch") {
                document.getElementById('scoreA').innerText = scoreB;
                document.getElementById('scoreB').innerText = scoreA;
            } else if (e == "reset") {
                document.getElementById('scoreA').innerText = 0;
                document.getElementById('scoreB').innerText = 0;
            } else if (e.indexOf('_') !== -1) {
                result = e.split('_');
                var score = Number(document.getElementById(`score${result[0]}`).textContent);
                if (result[1] == "plus") {
                    if (score == 50) {
                        return
                    }
                    document.getElementById(`score${result[0]}`).innerText = score + 1;
                } else if (result[1] == "minus") {
                    if (score == 0) {
                        return
                    }
                    document.getElementById(`score${result[0]}`).innerText = score - 1;
                }
            }
            var scoreA = Number(document.getElementById('scoreA').textContent);
            var scoreB = Number(document.getElementById('scoreB').textContent);
            if (scoreA > scoreB) {
                document.getElementById('difference').innerText = scoreA - scoreB
            } else {
                document.getElementById('difference').innerText = scoreB - scoreA
            }
            document.getElementById('difference').innerText = "点差:" + document.getElementById('difference').textContent
            console.log(e);
        }
        function setting() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4) {
                    if (xmlhttp.status == 200) {
                        document.getElementById("body").innerHTML = xmlhttp.responseText;
                    } else {
                        alert("status = " + xmlhttp.status);
                    }
                }
            }
            xmlhttp.open("GET", "https://raw.githubusercontent.com/HRTK92/badminton-tool/main/setting.html");
            xmlhttp.send();

        }
    </script>
    
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
</body>

</html>